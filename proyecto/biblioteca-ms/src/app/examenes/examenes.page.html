<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title>{{ 'exams.pageTitle' | translate }}</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="cerrarSesion()" shape="round" fill="solid" class="logout-button">
        <span class="logout-text">{{ 'profile.actions.logout' | translate }}</span>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="contenido">
  <ion-grid>
    <ion-text class="titulo visible-dark">
      {{ 'exams.welcomeTitle' | translate }}
    </ion-text>
  </ion-grid>
  
  <div class="files">
    <label for="fileInput">{{ 'exams.selectFileLabel' | translate }}</label>
    <input
      id="fileInput"
      type="file"
      accept="image/jpeg,image/png,image/jpg,application/pdf"
      (change)="onFileChange($event)"
      [title]="'exams.selectFileTitle' | translate"
    />
  </div>
  
  <div class="upload-button-container">
    <ion-button expand="block" (click)="subirImagen()" [disabled]="!selectedFile || loading">
      {{ 'exams.uploadButton' | translate }}
    </ion-button>
  </div>

  <ion-spinner *ngIf="loading"></ion-spinner>
  <ion-text color="danger" *ngIf="showStatusMessages && error">{{ error | translate }}</ion-text>
  <ion-text class="no-examenes-text" *ngIf="showStatusMessages && examenes.length === 0 && !loading">
    {{ 'exams.noExamsAvailable' | translate }}
  </ion-text>

  <ion-list *ngIf="examenes.length > 0">
    <ion-item *ngFor="let examen of examenes">
      <ion-label>
        <h2>{{ examen.examen }}</h2>
        <p>{{ 'exams.dateLabel' | translate }} {{ examen.fecha_subida | date:'dd/MM/yyyy HH:mm' }}</p>
        <p>{{ 'exams.idLabel' | translate }} {{ examen.idexamen }}</p>
      </ion-label>
      
      <!-- Mostrar vista previa si es imagen -->
      <div *ngIf="examen.imagen && examen.imagen.startsWith('data:image')" slot="end" class="preview-container">
        <img
          [src]="examen.imagen"
          class="examen-img"
          alt="Examen {{ examen.idexamen }}"
        />
      </div>
      
      <!-- Mostrar Ã­cono de PDF -->
      <ion-icon 
        *ngIf="examen.imagen && examen.imagen.startsWith('data:application/pdf')" 
        name="document-text" 
        slot="end"
        size="large"
        color="primary">
      </ion-icon>
      
      <ion-button color="danger" (click)="eliminarExamen(examen.idexamen)" slot="end">
        Eliminar
      </ion-button>
    </ion-item>
  </ion-list>
</ion-content>
